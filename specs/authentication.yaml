loginApiInit:
  get:
    description: This endpoint initiates a login flow for API clients that do not use a browser.
    summary: Initializes Login Flow for APIs, Services, Apps...
    operationId: init-user-login
    parameters:
      - name: refresh
        in: query
        required: false
        explode: true
        schema:
          type: boolean
        style: form
        description: |-
          Refresh a login.

          If set to true, this will refresh an existing login session by
          asking the user to sign in again. This will reset the
          authenticated_at time of the session.
      - name: X-Session-Token
        in: header
        required: false
        explode: false
        schema: 
          type: string
        style: simple
        description: The Session token of the Session performing the flow. Required when using the refresh parameter
    responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '../schemas/kratos_t.yaml#/selfServiceLoginFlow'
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '../schemas/kratos_t.yaml#/jsonError'
        "500":
          description: Internal Service Error
          content:
            application/json:
              schema:
                $ref: '../schemas/kratos_t.yaml#/jsonError'
    x-accepts: application/json
    tags:
      - authentication
### TPL RENDER {{ template "servers.tpl" "auth" }}
    servers:
      - url: https://auth.api.{environment}.mindtastic.lol
        variables:
          environment:
            enum:
              - live
              - stage
              - dev
            default: live
### END RENDER {{ template "servers.tpl" "auth" }}

loginSubmit:
  post:
    description: |-
      Use this endpoint to submit a login flow with credentials and log a user in.

      If the login is an API flow, it expects 'application/json' to be sent and responds with:
      HTTP 200 and a response with a session token in the body
      HTTP 410 if the flow reference in the request parameters expired
      HTTP 400 on validation errors
    summary: Submit a Login Flow
    parameters: 
      - $ref: '../schemas/authentication.yaml#/flow'
    requestBody:
      content:
        application/json:
          schema:
            $ref: '../schemas/kratos_t.yaml#/submitSelfServiceLoginFlowBody'
    responses:
      "200":
        description: "OK."
        content:
          application/json:
            schema:
              $ref: '../schemas/authentication.yaml#/session'
      "303":
        description: Returns the after login redirection url when a browser flow got submitted.
      "400":
        description: Invalid request body
        content:
          application/json:
            schema:
              $ref: '../schemas/kratos_t.yaml#/selfServiceLoginFlow'
      "410":
        description: Internal server error
        content:
          application/json:
            schema:
              $ref: '../schemas/kratos_t.yaml#/jsonError'
      "422":
        description: Browser login flow requires location change
        content:
          application/json:
            schema:
              $ref: '../schemas/kratos_t.yaml#/selfServiceBrowserLocationChangeRequiredError'
      "500":
        description: Internal server error
        content:
          application/json:
            schema:
              $ref: '../schemas/kratos_t.yaml#/jsonError'
    x-accepts: application/json
    x-contentType: application/json
    tags:
      - authentication
    operationId: submit-user-login
### TPL RENDER {{ template "servers.tpl" "auth" }}
    servers:
      - url: https://auth.api.{environment}.mindtastic.lol
        variables:
          environment:
            enum:
              - live
              - stage
              - dev
            default: live
### END RENDER {{ template "servers.tpl" "auth" }}

logout:
  delete:
    operationId: user-logout
    summary: Self-Service Logout
    description: |-
      This endpoint logs out an identity in a self-service manner and invalidates a session token.
      Not completly documented yet.
    responses:
      '200':
        description: OK
      '500':
        description: Internal Service Error
    tags:
      - authentication
### TPL RENDER {{ template "servers.tpl" "auth" }}
    servers:
      - url: https://auth.api.{environment}.mindtastic.lol
        variables:
          environment:
            enum:
              - live
              - stage
              - dev
            default: live
### END RENDER {{ template "servers.tpl" "auth" }} 